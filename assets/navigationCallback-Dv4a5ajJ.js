class s{static encodeCallback(a,t,e){const r=new URL(a,window.location.origin);return r.searchParams.set("returnPath",t),e?.query&&r.searchParams.set("returnQuery",JSON.stringify(e.query)),e?.fragment&&r.searchParams.set("returnFragment",e.fragment),e?.contextData&&r.searchParams.set("contextData",JSON.stringify(e.contextData)),r.pathname+r.search}static decodeCallback(a){const t=a.get("returnPath");if(!t)return null;const e={returnPath:t},r=a.get("returnQuery");if(r)try{e.returnQuery=JSON.parse(r)}catch(l){console.warn("Failed to parse returnQuery:",l)}const c=a.get("returnFragment");c&&(e.returnFragment=c);const n=a.get("contextData");if(n)try{e.contextData=JSON.parse(n)}catch(l){console.warn("Failed to parse contextData:",l)}return e}static executeCallback(a,t,e){let r=t.returnPath;if(t.returnQuery){const c=new URL(r,window.location.origin);Object.entries(t.returnQuery).forEach(([n,l])=>{c.searchParams.set(n,l)}),r=c.pathname+c.search}t.returnFragment&&(r+="#"+t.returnFragment),a(r),e?.cleanupHistory&&setTimeout(()=>{if(t.returnFragment){const c=r.split("#")[0];window.history.replaceState(null,"",c)}if(e?.scrollToElement){const c=document.getElementById(e.scrollToElement);c&&c.scrollIntoView({behavior:"smooth",block:"start"})}},100)}static createCallbackFromCurrent(a,t){const e=window.location.pathname,r=new URLSearchParams(window.location.search),c=window.location.hash.substring(1),n={};if(t?.preserveQuery&&r.toString()){const l={};r.forEach((u,i)=>{!i.startsWith("return")&&i!=="contextData"&&(l[i]=u)}),Object.keys(l).length>0&&(n.query=l)}return t?.preserveFragment&&c&&(n.fragment=c),t?.contextData&&(n.contextData=t.contextData),this.encodeCallback(a,e,n)}static smartGoBack(a,t,e="/"){const r=this.decodeCallback(t);r?this.executeCallback(a,r,{cleanupHistory:!0}):window.history.length>1?window.history.back():a(e)}static handleErrorWithCallback(a,t,e){const r=e?.delay??3e3,c=e?.fallbackPath??"/";setTimeout(()=>{if(e?.preserveErrorState){const n=this.decodeCallback(t);n&&n.returnQuery&&(n.returnQuery.error="operation_failed"),n?this.executeCallback(a,n,{cleanupHistory:!0}):a(c+"?error=operation_failed")}else this.smartGoBack(a,t,c)},r)}}const h=o=>{const a=s.decodeCallback(o);return{hasCallback:!!a,callbackState:a,executeCallback:t=>{a&&s.executeCallback(t,a,{cleanupHistory:!0})},smartGoBack:(t,e)=>{s.smartGoBack(t,o,e)},handleErrorWithCallback:(t,e)=>{s.handleErrorWithCallback(t,o,e)}}};class b extends s{static createDayCallback(a,t,e){const r=`/trips/${t}`;return this.encodeCallback(a,r,{fragment:`day-${e}`,contextData:{selectedDay:e,tripId:t}})}static executeDayCallback(a,t){this.executeCallback(a,t,{cleanupHistory:!0,scrollToElement:t.contextData?.selectedDay?`day-tab-${t.contextData.selectedDay}`:void 0})}}export{b as D,s as N,h as u};
//# sourceMappingURL=navigationCallback-Dv4a5ajJ.js.map
