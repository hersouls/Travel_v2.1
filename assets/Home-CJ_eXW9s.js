import{j as e,G as d,c as T,u as k,a as _,H as D,W as b,q as P,b as S,d as v,w as E,o as $,e as q,f as A,g as F}from"./index-qCsHU5cu.js";import{I as H,e as I,T as K,f as N,C as w,r as x,g,h as L}from"./ui-DVQGuqmb.js";import{F as M}from"./Footer-BdqaH0Mx.js";import{t as W}from"./time-Ctdjibtq.js";import"./vendor-gH-7aFTg.js";const B=({trip:t,onClick:n,onEdit:r,onDelete:i,className:h,showActions:u=!1,...c})=>{const o=l=>new Date(l).toLocaleDateString("ko-KR",{year:"numeric",month:"long",day:"numeric",timeZone:"Asia/Seoul"}),p=()=>{const l=new Date(t.start_date),s=new Date(t.end_date),a=Math.abs(s.getTime()-l.getTime());return`${Math.ceil(a/(1e3*60*60*24))+1}일`},f=l=>{l.target.closest(".action-button")||n?.()};return e.jsxs(d,{variant:"travel",hoverable:!!n,withWaveEffect:!0,className:T("cursor-pointer group transition-all duration-300","hover:scale-105 hover:shadow-2xl",h),onClick:f,...c,children:[e.jsxs("div",{className:"relative w-full h-32 sm:h-36 md:h-40 mb-4 rounded-xl overflow-hidden bg-gradient-to-br from-travel-blue/20 to-travel-purple/20",children:[t.cover_image?e.jsx("img",{src:t.cover_image,alt:t.title,className:"w-full h-full object-cover"}):e.jsx("div",{className:"w-full h-full flex items-center justify-center",children:e.jsx(H,{className:"w-8 h-8 sm:w-10 sm:h-10 md:w-12 md:h-12 text-white/60"})}),e.jsx("div",{className:"absolute top-2 right-2 sm:top-3 sm:right-3 bg-black/30 backdrop-blur-sm rounded-full px-2 py-1 sm:px-3 sm:py-1",children:e.jsx("span",{className:"text-white text-xs sm:text-sm font-semibold",children:p()})}),u&&(r||i)&&e.jsxs("div",{className:"absolute top-2 left-2 sm:top-3 sm:left-3 flex items-center space-x-1 opacity-80 sm:opacity-60 sm:group-hover:opacity-100 transition-opacity",children:[r&&e.jsx("button",{type:"button",onClick:l=>{l.stopPropagation(),r()},className:"action-button p-2 rounded-lg bg-blue-500/20 hover:bg-blue-500/40 transition-colors backdrop-blur-sm","aria-label":"여행 편집",children:e.jsx(I,{className:"w-3 h-3 text-blue-300"})}),i&&e.jsx("button",{type:"button",onClick:l=>{l.stopPropagation(),window.confirm("이 여행을 삭제하시겠습니까?")&&i()},className:"action-button p-2 rounded-lg bg-red-500/20 hover:bg-red-500/40 transition-colors backdrop-blur-sm","aria-label":"여행 삭제",children:e.jsx(K,{className:"w-3 h-3 text-red-300"})})]})]}),e.jsxs("div",{className:"space-y-2 sm:space-y-3",children:[e.jsx("h3",{className:"text-lg sm:text-xl font-bold text-white group-hover:text-travel-blue transition-colors line-clamp-2",children:t.title}),e.jsxs("div",{className:"flex items-center space-x-2 text-white/80",children:[e.jsx(N,{className:"w-3 h-3 sm:w-4 sm:h-4"}),e.jsx("span",{className:"text-xs sm:text-sm",children:t.country})]}),e.jsxs("div",{className:"flex items-center space-x-2 text-white/80",children:[e.jsx(w,{className:"w-3 h-3 sm:w-4 sm:h-4"}),e.jsxs("span",{className:"text-xs sm:text-sm",children:[o(t.start_date)," ~ ",o(t.end_date)]})]}),t.plans_count!==void 0&&e.jsxs("div",{className:"flex justify-between items-center pt-2 border-t border-white/10",children:[e.jsx("span",{className:"text-white/60 text-xs sm:text-sm",children:"일정"}),e.jsxs("span",{className:"text-travel-orange font-semibold text-xs sm:text-sm",children:[t.plans_count,"개"]})]})]})]})},J=()=>{const{user:t,loading:n}=k(),r=_(),[i,h]=x.useState([]),[u,c]=x.useState(!1);x.useEffect(()=>{!n&&!t&&r("/login")},[n,t,r]),x.useEffect(()=>{if(!t)return;const a=(async()=>{c(!0);try{const m=P(S(v,"trips"),E("user_id","==",t.uid),$("created_at","desc"));return q(m,y=>{const C=y.docs.map(j=>({id:j.id,...j.data()}));h(C),c(!1)})}catch(m){console.error("여행 데이터 로드 실패:",m),c(!1)}})();return()=>{a instanceof Function&&a()}},[t]);const o=()=>{r("/trips/new")},p=s=>{r(`/trips/${s.id}`)},f=s=>{r(`/trips/${s.id}/edit`)},l=async s=>{if(s.id)try{await A(F(v,"trips",s.id))}catch(a){console.error("여행 삭제 실패:",a),alert("여행 삭제에 실패했습니다.")}};return n?e.jsx("div",{className:"min-h-screen flex items-center justify-center",children:e.jsx("div",{className:"text-white text-lg",children:"로딩 중..."})}):t?e.jsxs("div",{className:"min-h-screen",children:[e.jsx(D,{}),e.jsx("div",{className:"pt-20 px-4 pb-24",children:e.jsxs("div",{className:"max-w-7xl mx-auto",children:[e.jsx("div",{className:"mb-6",children:e.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 gap-4",children:[e.jsxs(d,{variant:"light",className:"text-center p-4 animate-fade-in",children:[e.jsx(N,{className:"w-8 h-8 text-travel-green mx-auto mb-2"}),e.jsx("div",{className:"text-2xl font-bold text-white",children:i.length}),e.jsx("div",{className:"text-white/60 text-sm",children:"여행"})]}),e.jsxs(d,{variant:"light",className:"text-center p-4 animate-fade-in",children:[e.jsx(w,{className:"w-8 h-8 text-travel-orange mx-auto mb-2"}),e.jsx("div",{className:"text-2xl font-bold text-white",children:i.reduce((s,a)=>s+(a.plans_count||0),0)}),e.jsx("div",{className:"text-white/60 text-sm",children:"일정"})]}),e.jsxs(d,{variant:"light",className:"text-center p-4 animate-fade-in",children:[e.jsx(g,{className:"w-8 h-8 text-travel-purple mx-auto mb-2"}),e.jsx("div",{className:"text-2xl font-bold text-white",children:(()=>{const s=W();return i.filter(a=>(a.end_date||"")<s).length})()}),e.jsx("div",{className:"text-white/60 text-sm",children:"완료"})]})]})}),e.jsx("div",{className:"mb-6",children:e.jsxs(b,{variant:"travel",size:"lg",onClick:o,className:"w-full",children:[e.jsx(L,{className:"w-5 h-5 mr-2"}),"새 여행 만들기"]})}),e.jsxs("div",{className:"pb-6",children:[e.jsx("h2",{className:"text-xl font-bold text-white mb-4",children:"내 여행"}),u?e.jsx("div",{className:"text-center text-white/60 py-8",children:"여행 목록을 불러오는 중..."}):i.length===0?e.jsxs(d,{variant:"light",className:"text-center py-8 animate-fade-in",children:[e.jsx(g,{className:"w-16 h-16 text-white/40 mx-auto mb-4"}),e.jsx("p",{className:"text-white/60 mb-4",children:"아직 여행이 없어요"}),e.jsx(b,{variant:"ghost",onClick:o,children:"첫 번째 여행 만들기"})]}):e.jsx("div",{className:"space-y-4",children:i.map((s,a)=>e.jsx("div",{className:"animate-fade-in",style:{animationDelay:`${a*.1}s`},children:e.jsx(B,{trip:s,onClick:()=>p(s),onEdit:()=>f(s),onDelete:()=>l(s),showActions:!0})},s.id))})]})]})}),e.jsx(M,{})]}):null};export{J as Home};
//# sourceMappingURL=Home-CJ_eXW9s.js.map
