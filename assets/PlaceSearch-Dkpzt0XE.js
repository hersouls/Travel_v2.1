import{u as se,a as te,m as ae,q as re,b as B,d as j,e as le,j as e,H as M,W as h,G as f,T as b,k as ie,t as $,g as q,y as ne}from"./index-BLdSJBwv.js";import{r as n,h as k,k as O,F as ce,N as R,o as P,f as T,s as z,l as oe,q as de,B as ue,p as xe}from"./ui-DVQGuqmb.js";import{u as me}from"./navigationCallback-Dv4a5ajJ.js";import{F as H}from"./Footer-DQJht34C.js";import"./vendor-gH-7aFTg.js";const he=({place:a,onSelect:d,onToggleFavorite:p})=>{const w=c=>{switch(c){case"attraction":return e.jsx(P,{className:"w-5 h-5 text-travel-orange"});case"restaurant":return e.jsx(xe,{className:"w-5 h-5 text-travel-green"});case"hotel":return e.jsx(ue,{className:"w-5 h-5 text-travel-purple"});case"transport":return e.jsx(de,{className:"w-5 h-5 text-travel-blue"});default:return e.jsx(T,{className:"w-5 h-5 text-white/80"})}},u=c=>{switch(c){case"attraction":return"ê´€ê´‘ì§€";case"restaurant":return"ìŒì‹ì ";case"hotel":return"ìˆ™ì†Œ";case"transport":return"êµí†µ";default:return"ê¸°íƒ€"}};return e.jsx(f,{variant:"light",hoverable:!0,className:"cursor-pointer",children:e.jsxs("div",{className:"flex items-start justify-between",children:[e.jsxs("div",{className:"flex-1 min-w-0",onClick:()=>d(a),children:[e.jsxs("div",{className:"flex items-center space-x-2 mb-2",children:[w(a.type),e.jsx("span",{className:"text-xs text-white/60 bg-white/10 px-2 py-1 rounded-full",children:u(a.type)}),a.favorite&&e.jsx(z,{className:"w-4 h-4 text-red-400 fill-current"})]}),e.jsx("h3",{className:"text-lg font-semibold text-white mb-1 truncate",children:a.name}),a.address&&e.jsxs("div",{className:"flex items-center space-x-1 text-white/60 text-sm mb-2",children:[e.jsx(T,{className:"w-3 h-3"}),e.jsx("span",{className:"truncate",children:a.address})]}),a.rating&&a.rating>0&&e.jsxs("div",{className:"flex items-center space-x-1 mb-2",children:[e.jsx(P,{className:"w-4 h-4 text-yellow-400 fill-current"}),e.jsx("span",{className:"text-white/80 text-sm",children:a.rating})]}),a.latitude&&a.longitude&&e.jsxs("div",{className:"flex items-center space-x-1 text-white/50 text-xs mb-2",children:[e.jsx(R,{className:"w-3 h-3"}),e.jsxs("span",{children:[a.latitude.toFixed(6),", ",a.longitude.toFixed(6)]})]}),e.jsxs("div",{className:"flex items-center justify-between text-xs text-white/50",children:[e.jsxs("div",{className:"flex items-center space-x-1",children:[e.jsx(oe,{className:"w-3 h-3"}),e.jsxs("span",{children:[a.usage_count||0,"ë²ˆ ì‚¬ìš©"]})]}),a.created_at&&e.jsx("span",{children:a.created_at.toDate().toLocaleDateString("ko-KR")})]})]}),e.jsx("button",{onClick:c=>{c.stopPropagation(),p(a)},className:"ml-2 p-2 hover:bg-white/10 rounded-lg transition-colors",children:e.jsx(z,{className:`w-5 h-5 ${a.favorite?"text-red-400 fill-current":"text-white/40"}`})})]})})},be=()=>{const{user:a}=se(),d=te(),[p]=ae(),{smartGoBack:w}=me(p),u=p.get("trip"),[c,U]=n.useState([]),[x,G]=n.useState(""),[v,Q]=n.useState("all"),[N,W]=n.useState("recent"),[K,_]=n.useState(!0),[F,g]=n.useState(!1),[I,i]=n.useState(null),[L,m]=n.useState(null),[y,D]=n.useState(!1),[r,o]=n.useState({name:"",address:"",type:"attraction",rating:0,latitude:"",longitude:""}),E=[{value:"all",label:"ì „ì²´",icon:"ðŸ“"},{value:"attraction",label:"ê´€ê´‘ì§€",icon:"ðŸ›ï¸"},{value:"restaurant",label:"ìŒì‹ì ",icon:"ðŸ½ï¸"},{value:"hotel",label:"ìˆ™ì†Œ",icon:"ðŸ¨"},{value:"transport",label:"êµí†µ",icon:"ðŸš—"},{value:"other",label:"ê¸°íƒ€",icon:"ðŸ“"}],V=[{value:"recent",label:"ìµœê·¼ ì¶”ê°€ìˆœ"},{value:"favorite",label:"ì¦ê²¨ì°¾ê¸°"},{value:"usage",label:"ìžì£¼ ì‚¬ìš©"}];n.useEffect(()=>{if(!a)return;const s=re(B(j,"users",a.uid,"places"));return le(s,l=>{const C=l.docs.map(A=>({id:A.id,...A.data()}));U(C),_(!1)},l=>{console.error("Places ë¡œë”© ì‹¤íŒ¨:",l),_(!1)})},[a]);const S=n.useMemo(()=>{let s=c;if(x.trim()){const t=x.toLowerCase().trim();s=s.filter(l=>l.name.toLowerCase().includes(t)||l.address&&l.address.toLowerCase().includes(t))}return v!=="all"&&(s=s.filter(t=>t.type===v)),s.sort((t,l)=>{switch(N){case"favorite":return t.favorite&&!l.favorite?-1:!t.favorite&&l.favorite?1:(l.usage_count||0)-(t.usage_count||0);case"usage":return(l.usage_count||0)-(t.usage_count||0);case"recent":default:return l.created_at.toMillis()-t.created_at.toMillis()}}),s},[c,x,v,N]),J=async s=>{try{if(i(null),await $(q(j,"users",a.uid,"places",s.id),{usage_count:ne(1),last_used:b.now()}),u){const t=new URLSearchParams({place_name:s.name,address:s.address||"",type:s.type,rating:s.rating?.toString()||"0",latitude:s.latitude?.toString()||"",longitude:s.longitude?.toString()||""});d(`/trips/${u}/plans/new?${t.toString()}`)}else w(d,"/")}catch(t){console.error("ìž¥ì†Œ ì„ íƒ ì‹¤íŒ¨:",t),i("ìž¥ì†Œ ì„ íƒ ì¤‘ ì˜¤ë¥˜ê°€ ë°œìƒí–ˆìŠµë‹ˆë‹¤. ë‹¤ì‹œ ì‹œë„í•´ì£¼ì„¸ìš”."),setTimeout(()=>{u?d(`/trips/${u}/plans/new`):w(d,"/")},2e3)}},X=async s=>{try{i(null),await $(q(j,"users",a.uid,"places",s.id),{favorite:!s.favorite,updated_at:b.now()}),m(s.favorite?"ì¦ê²¨ì°¾ê¸°ì—ì„œ ì œê±°í–ˆìŠµë‹ˆë‹¤.":"ì¦ê²¨ì°¾ê¸°ì— ì¶”ê°€í–ˆìŠµë‹ˆë‹¤."),setTimeout(()=>m(null),3e3)}catch(t){console.error("ì¦ê²¨ì°¾ê¸° í† ê¸€ ì‹¤íŒ¨:",t),i("ì¦ê²¨ì°¾ê¸° ì„¤ì • ì¤‘ ì˜¤ë¥˜ê°€ ë°œìƒí–ˆìŠµë‹ˆë‹¤."),setTimeout(()=>i(null),5e3)}},Y=async s=>{if(s.preventDefault(),!(!a||!r.name.trim())){D(!0),i(null);try{const t={name:r.name.trim(),address:r.address.trim()||void 0,type:r.type,rating:r.rating||void 0,latitude:r.latitude?parseFloat(r.latitude):void 0,longitude:r.longitude?parseFloat(r.longitude):void 0,favorite:!1,usage_count:0,created_at:b.now(),updated_at:b.now()};await ie(B(j,"users",a.uid,"places"),t),o({name:"",address:"",type:"attraction",rating:0,latitude:"",longitude:""}),g(!1),m("ìƒˆ ìž¥ì†Œê°€ ì„±ê³µì ìœ¼ë¡œ ì¶”ê°€ë˜ì—ˆìŠµë‹ˆë‹¤!"),setTimeout(()=>m(null),3e3)}catch(t){console.error("ìƒˆ ìž¥ì†Œ ì¶”ê°€ ì‹¤íŒ¨:",t),i("ìž¥ì†Œ ì¶”ê°€ ì¤‘ ì˜¤ë¥˜ê°€ ë°œìƒí–ˆìŠµë‹ˆë‹¤. ë‹¤ì‹œ ì‹œë„í•´ì£¼ì„¸ìš”."),setTimeout(()=>i(null),5e3)}finally{D(!1)}}},Z=()=>{if(!navigator.geolocation){i("ì´ ë¸Œë¼ìš°ì €ì—ì„œëŠ” ìœ„ì¹˜ ì„œë¹„ìŠ¤ë¥¼ ì§€ì›í•˜ì§€ ì•ŠìŠµë‹ˆë‹¤.");return}i(null),navigator.geolocation.getCurrentPosition(s=>{const{latitude:t,longitude:l}=s.coords;o(C=>({...C,latitude:t.toString(),longitude:l.toString()})),m("í˜„ìž¬ ìœ„ì¹˜ê°€ ì„¤ì •ë˜ì—ˆìŠµë‹ˆë‹¤."),setTimeout(()=>m(null),3e3)},s=>{console.error("ìœ„ì¹˜ ì •ë³´ ê°€ì ¸ì˜¤ê¸° ì‹¤íŒ¨:",s);let t="ìœ„ì¹˜ ì •ë³´ë¥¼ ê°€ì ¸ì˜¬ ìˆ˜ ì—†ìŠµë‹ˆë‹¤.";switch(s.code){case s.PERMISSION_DENIED:t="ìœ„ì¹˜ ì ‘ê·¼ ê¶Œí•œì´ ê±°ë¶€ë˜ì—ˆìŠµë‹ˆë‹¤.";break;case s.POSITION_UNAVAILABLE:t="ìœ„ì¹˜ ì •ë³´ë¥¼ ì‚¬ìš©í•  ìˆ˜ ì—†ìŠµë‹ˆë‹¤.";break;case s.TIMEOUT:t="ìœ„ì¹˜ ì •ë³´ ìš”ì²­ì´ ì‹œê°„ ì´ˆê³¼ë˜ì—ˆìŠµë‹ˆë‹¤.";break}i(t),setTimeout(()=>i(null),5e3)},{enableHighAccuracy:!0,timeout:1e4,maximumAge:6e4})},ee=()=>e.jsx(f,{variant:"light",className:"animate-pulse",children:e.jsxs("div",{className:"flex items-start justify-between",children:[e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsxs("div",{className:"flex items-center space-x-2 mb-2",children:[e.jsx("div",{className:"w-5 h-5 bg-white/20 rounded"}),e.jsx("div",{className:"w-16 h-6 bg-white/20 rounded-full"})]}),e.jsx("div",{className:"w-3/4 h-6 bg-white/20 rounded mb-2"}),e.jsx("div",{className:"w-1/2 h-4 bg-white/20 rounded mb-2"}),e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("div",{className:"w-20 h-4 bg-white/20 rounded"}),e.jsx("div",{className:"w-24 h-4 bg-white/20 rounded"})]})]}),e.jsx("div",{className:"ml-2 w-9 h-9 bg-white/20 rounded-lg"})]})});return K?e.jsxs("div",{className:"min-h-screen",children:[e.jsx(M,{}),e.jsx("div",{className:"pt-20 px-4 pb-6",children:e.jsxs("div",{className:"max-w-7xl mx-auto",children:[e.jsxs("div",{className:"flex items-center justify-between mb-6",children:[e.jsx("h1",{className:"text-2xl font-bold text-white text-center flex-1 text-glow",children:"ìž¥ì†Œ ê²€ìƒ‰"}),e.jsx("div",{className:"w-10 h-10 bg-white/20 rounded-lg animate-pulse"})]}),e.jsx("div",{className:"mb-6",children:e.jsx("div",{className:"w-full h-12 bg-white/10 rounded-xl animate-pulse"})}),e.jsxs("div",{className:"mb-6 space-y-4",children:[e.jsx("div",{className:"flex space-x-2 overflow-x-auto pb-2",children:[1,2,3,4,5].map(s=>e.jsx("div",{className:"flex-shrink-0 w-20 h-10 bg-white/10 rounded-lg animate-pulse"},s))}),e.jsx("div",{className:"flex space-x-2",children:[1,2,3].map(s=>e.jsx("div",{className:"w-24 h-10 bg-white/10 rounded-lg animate-pulse"},s))})]}),e.jsx("div",{className:"space-y-4",children:[1,2,3,4,5].map(s=>e.jsx(ee,{},s))})]})}),e.jsx(H,{})]}):e.jsxs("div",{className:"min-h-screen",children:[e.jsx(M,{}),e.jsx("div",{className:"pt-20 px-4 pb-6",children:e.jsxs("div",{className:"max-w-7xl mx-auto",children:[e.jsxs("div",{className:"flex items-center justify-between mb-6",children:[e.jsx("h1",{className:"text-2xl font-bold text-white text-center flex-1 text-glow",children:"ìž¥ì†Œ ê²€ìƒ‰"}),e.jsx(h,{variant:"ghost",size:"sm",onClick:()=>g(!F),className:"!p-2",children:e.jsx(k,{className:"w-5 h-5"})})]}),I&&e.jsx("div",{className:"mb-4 p-4 bg-red-500/20 border border-red-500/50 rounded-xl text-red-200 text-sm",children:I}),L&&e.jsx("div",{className:"mb-4 p-4 bg-green-500/20 border border-green-500/50 rounded-xl text-green-200 text-sm",children:L}),e.jsx("div",{className:"mb-6",children:e.jsxs("div",{className:"relative",children:[e.jsx(O,{className:"absolute left-4 top-1/2 transform -translate-y-1/2 w-5 h-5 text-white/50"}),e.jsx("input",{type:"text",value:x,onChange:s=>G(s.target.value),placeholder:"ìž¥ì†Œëª…ì´ë‚˜ ì£¼ì†Œë¡œ ê²€ìƒ‰...",className:"w-full pl-12 pr-4 py-3 bg-glass-light backdrop-blur-sm border border-white/20 rounded-xl text-white placeholder-white/50 focus:outline-none focus:border-primary-300 focus:ring-1 focus:ring-primary-300"})]})}),e.jsxs("div",{className:"mb-6 space-y-4",children:[e.jsxs("div",{children:[e.jsxs("div",{className:"flex items-center space-x-2 mb-2",children:[e.jsx(ce,{className:"w-4 h-4 text-white/60"}),e.jsx("span",{className:"text-white/60 text-sm",children:"ìœ í˜•"})]}),e.jsx("div",{className:"flex space-x-2 overflow-x-auto pb-2",children:E.map(s=>e.jsxs("button",{onClick:()=>Q(s.value),className:`flex-shrink-0 px-3 py-2 rounded-lg text-sm transition-all ${v===s.value?"bg-primary-500 text-white":"bg-white/10 text-white/70 hover:bg-white/20"}`,children:[s.icon," ",s.label]},s.value))})]}),e.jsxs("div",{children:[e.jsx("div",{className:"flex items-center space-x-2 mb-2",children:e.jsx("span",{className:"text-white/60 text-sm",children:"ì •ë ¬"})}),e.jsx("div",{className:"flex space-x-2",children:V.map(s=>e.jsx("button",{onClick:()=>W(s.value),className:`px-3 py-2 rounded-lg text-sm transition-all ${N===s.value?"bg-primary-500 text-white":"bg-white/10 text-white/70 hover:bg-white/20"}`,children:s.label},s.value))})]})]}),F&&e.jsxs(f,{variant:"travel",className:"mb-6",children:[e.jsx("h3",{className:"text-lg font-semibold text-white mb-4",children:"ìƒˆ ìž¥ì†Œ ì¶”ê°€"}),e.jsxs("form",{onSubmit:Y,className:"space-y-4",children:[e.jsx("div",{children:e.jsx("input",{type:"text",value:r.name,onChange:s=>o({...r,name:s.target.value}),placeholder:"ìž¥ì†Œëª… *",className:"w-full px-4 py-3 bg-white/10 border border-white/20 rounded-xl text-white placeholder-white/50 focus:outline-none focus:border-primary-300 focus:ring-1 focus:ring-primary-300",required:!0})}),e.jsx("div",{children:e.jsx("input",{type:"text",value:r.address,onChange:s=>o({...r,address:s.target.value}),placeholder:"ì£¼ì†Œ",className:"w-full px-4 py-3 bg-white/10 border border-white/20 rounded-xl text-white placeholder-white/50 focus:outline-none focus:border-primary-300 focus:ring-1 focus:ring-primary-300"})}),e.jsxs("div",{children:[e.jsxs("div",{className:"flex items-center justify-between mb-2",children:[e.jsx("span",{className:"text-white/70 text-sm",children:"ìœ„ì¹˜ ì¢Œí‘œ (ì„ íƒì‚¬í•­)"}),e.jsx(h,{type:"button",variant:"ghost",size:"sm",onClick:Z,className:"!p-2",title:"í˜„ìž¬ ìœ„ì¹˜ ê°€ì ¸ì˜¤ê¸°",children:e.jsx(R,{className:"w-4 h-4"})})]}),e.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 gap-4",children:[e.jsx("div",{children:e.jsx("input",{type:"number",step:"any",value:r.latitude,onChange:s=>o({...r,latitude:s.target.value}),placeholder:"ìœ„ë„ (latitude)",className:"w-full px-4 py-3 bg-white/10 border border-white/20 rounded-xl text-white placeholder-white/50 focus:outline-none focus:border-primary-300 focus:ring-1 focus:ring-primary-300"})}),e.jsx("div",{children:e.jsx("input",{type:"number",step:"any",value:r.longitude,onChange:s=>o({...r,longitude:s.target.value}),placeholder:"ê²½ë„ (longitude)",className:"w-full px-4 py-3 bg-white/10 border border-white/20 rounded-xl text-white placeholder-white/50 focus:outline-none focus:border-primary-300 focus:ring-1 focus:ring-primary-300"})})]})]}),e.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 gap-4",children:[e.jsx("select",{value:r.type,onChange:s=>o({...r,type:s.target.value}),className:"px-4 py-3 bg-white/10 border border-white/20 rounded-xl text-white focus:outline-none focus:border-primary-300 focus:ring-1 focus:ring-primary-300",children:E.filter(s=>s.value!=="all").map(s=>e.jsx("option",{value:s.value,className:"bg-primary-800",children:s.label},s.value))}),e.jsx("div",{className:"flex items-center space-x-2",children:[1,2,3,4,5].map(s=>e.jsx("button",{type:"button",onClick:()=>o({...r,rating:s}),className:`w-6 h-6 ${s<=r.rating?"text-yellow-400":"text-white/30"}`,children:e.jsx(P,{className:"w-6 h-6 fill-current"})},s))})]}),e.jsxs("div",{className:"flex space-x-2",children:[e.jsx(h,{type:"submit",variant:"travel",size:"sm",className:"flex-1",disabled:y||!r.name.trim(),children:y?"ì¶”ê°€ ì¤‘...":"ì¶”ê°€"}),e.jsx(h,{type:"button",variant:"ghost",size:"sm",onClick:()=>g(!1),disabled:y,children:"ì·¨ì†Œ"})]})]})]}),e.jsx("div",{className:"space-y-4",children:S.length===0?e.jsx(f,{variant:"light",className:"text-center py-8",children:x.trim()?e.jsxs(e.Fragment,{children:[e.jsx(O,{className:"w-16 h-16 text-white/40 mx-auto mb-4"}),e.jsxs("p",{className:"text-white/60 mb-4",children:["'",x,"'ì— ëŒ€í•œ ê²€ìƒ‰ ê²°ê³¼ê°€ ì—†ìŠµë‹ˆë‹¤"]}),e.jsxs(h,{variant:"travel",onClick:()=>g(!0),children:[e.jsx(k,{className:"w-4 h-4 mr-2"}),"ìƒˆ ìž¥ì†Œ ì¶”ê°€"]})]}):e.jsxs(e.Fragment,{children:[e.jsx(T,{className:"w-16 h-16 text-white/40 mx-auto mb-4"}),e.jsx("p",{className:"text-white/60 mb-4",children:"ì €ìž¥ëœ ìž¥ì†Œê°€ ì—†ì–´ìš”"}),e.jsxs(h,{variant:"travel",onClick:()=>g(!0),children:[e.jsx(k,{className:"w-4 h-4 mr-2"}),"ì²« ë²ˆì§¸ ìž¥ì†Œ ì¶”ê°€"]})]})}):e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"text-white/60 text-sm mb-2",children:[S.length,"ê°œì˜ ìž¥ì†Œ"]}),S.map(s=>e.jsx(he,{place:s,onSelect:J,onToggleFavorite:X},s.id))]})})]})}),e.jsx(H,{})]})};export{be as PlaceSearch};
//# sourceMappingURL=PlaceSearch-Dkpzt0XE.js.map
